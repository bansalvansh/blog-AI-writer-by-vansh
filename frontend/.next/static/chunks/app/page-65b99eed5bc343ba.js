(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{75:function(e,t,s){Promise.resolve().then(s.bind(s,707))},707:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var n=s(3827),o=s(4090),a=s(1231),r=s(5620);function i(e){let{conversationId:t,setContent:s,setLoading:a}=e,[i,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(!1),u=async e=>{e.preventDefault(),a(!0);try{let e=await fetch("http://localhost:8000/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:i,type:c?"book":"blog",conversation_id:t})}),n=await e.json();if(n.success)s(n);else throw Error(n.detail||"Failed to generate content")}catch(e){console.error("Error generating content:",e),alert("Failed to generate content. Please try again.")}finally{a(!1)}};return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,n.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"topic",className:"block text-sm font-medium text-gray-700",children:"What would you like to write about?"}),(0,n.jsx)("input",{type:"text",id:"topic",value:i,onChange:e=>l(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter your topic...",required:!0})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(r.r,{checked:c,onChange:d,className:"".concat(c?"bg-indigo-600":"bg-gray-200"," relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"),children:(0,n.jsx)("span",{className:"".concat(c?"translate-x-6":"translate-x-1"," inline-block h-4 w-4 transform rounded-full bg-white transition-transform")})}),(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["Generate a ",c?"book":"blog post"]})]}),(0,n.jsx)("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Generate Content"})]})})}function l(e){let{conversationId:t}=e,[s,a]=(0,o.useState)([]),[r,i]=(0,o.useState)(null);return(0,o.useEffect)(()=>{fetch("http://localhost:8000/conversations/".concat(t)).then(e=>e.json()).then(e=>a(e.conversation||[]));let e=new WebSocket("ws://localhost:8000/ws/conversation/".concat(t));return i(e),e.onmessage=e=>{let t=JSON.parse(e.data);"message"===t.type&&a(e=>[...e,t])},()=>{e.close()}},[t]),(0,n.jsxs)("div",{className:"h-full overflow-y-auto",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Conversation History"}),(0,n.jsx)("div",{className:"space-y-4",children:s.map((e,t)=>(0,n.jsxs)("div",{className:"p-3 rounded-lg ".concat("user"===e.role?"bg-blue-100":"bg-gray-100"),children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"user"===e.role?"You":"AI"}),(0,n.jsx)("div",{className:"mt-1 text-sm text-gray-700",children:e.content}),(0,n.jsx)("div",{className:"mt-1 text-xs text-gray-500",children:e.timestamp})]},t))})]})}var c=s(7607);function d(e){let{content:t}=e,[s,a]=(0,o.useState)(null),[r,i]=(0,o.useState)(""),l=async e=>{try{let s=await fetch("http://localhost:8000/edit-section",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t.file_path,section_id:e,instructions:r})}),n=await s.json();if(n.success)a(null),i("");else throw Error(n.detail||"Failed to update section")}catch(e){console.error("Error updating section:",e),alert("Failed to update section. Please try again.")}};return"blog"===t.type?(0,n.jsxs)("div",{className:"mt-8 prose prose-lg max-w-none",children:[(0,n.jsx)("h1",{children:t.content.title}),t.content.sections.map(e=>(0,n.jsx)(c.J,{className:"relative",children:(0,n.jsxs)("div",{className:"hover:bg-gray-50 p-2 rounded transition-colors cursor-pointer group",onMouseEnter:()=>a(e.id),onMouseLeave:()=>a(null),children:[(0,n.jsx)("div",{className:"prose",children:e.content}),s===e.id&&(0,n.jsx)(c.J.Panel,{className:"absolute z-10 w-96 px-4 mt-3 transform -translate-x-1/2 left-1/2",children:(0,n.jsx)("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black ring-opacity-5",children:(0,n.jsxs)("div",{className:"relative bg-white p-4",children:[(0,n.jsx)("textarea",{className:"w-full p-2 border rounded",placeholder:"How would you like to change this section?",value:r,onChange:e=>i(e.target.value),rows:4}),(0,n.jsx)("button",{onClick:()=>l(e.id),className:"mt-2 w-full bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Update Section"})]})})})]})},e.id))]}):"book"===t.type?(0,n.jsxs)("div",{className:"mt-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:t.title}),(0,n.jsxs)("p",{className:"mt-4",children:["Your book has been generated and saved to: ",(0,n.jsx)("br",{}),(0,n.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:t.file_path})]}),(0,n.jsx)("button",{onClick:()=>window.open("/api/download?path=".concat(encodeURIComponent(t.file_path))),className:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Download Book"})]}):null}function u(){let[e]=(0,o.useState)((0,a.Z)()),[t,s]=(0,o.useState)(null),[r,c]=(0,o.useState)(!1);return(0,n.jsxs)("main",{className:"flex min-h-screen bg-gray-100",children:[(0,n.jsx)("div",{className:"w-1/4 bg-white border-r border-gray-200 p-4",children:(0,n.jsx)(l,{conversationId:e})}),(0,n.jsx)("div",{className:"flex-1 p-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsx)(i,{conversationId:e,setContent:s,setLoading:c}),r&&(0,n.jsxs)("div",{className:"mt-8 text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Generating your content..."})]}),t&&!r&&(0,n.jsx)(d,{content:t})]})})]})}}},function(e){e.O(0,[814,971,150,744],function(){return e(e.s=75)}),_N_E=e.O()}]);